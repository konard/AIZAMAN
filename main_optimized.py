#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
üéØ –§–ò–ù–ê–õ–¨–ù–û–ï –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–û–ï –†–ï–®–ï–ù–ò–ï
–î–µ—Ç–æ–∫—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∞—Ç–∞—Ä—Å–∫–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤ –¥–ª—è J-score ‚â• 0.70

–û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω–æ–º –∞–Ω–∞–ª–∏–∑–µ:
- GPT-4o-mini —á–µ—Ä–µ–∑ Artemox API
- Chain-of-Thought –ø—Ä–æ–º–ø—Ç–∏–Ω–≥
- –ë–∞–ª–∞–Ω—Å STA/SIM/FL –º–µ—Ç—Ä–∏–∫
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å

–¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
- STA (–¥–µ—Ç–æ–∫—Å–∏—Ñ–∏–∫–∞—Ü–∏—è): ‚â•0.88
- SIM (—Å—Ö–æ–∂–µ—Å—Ç—å): ‚â•0.94
- FL (–±–µ–≥–ª–æ—Å—Ç—å): ‚â•0.94
- J-score: ‚â•0.70

–ê–≤—Ç–æ—Ä: AI Issue Solver
–î–∞—Ç–∞: 2025-11-30
"""

import re
import os
import pandas as pd
from openai import OpenAI
from tqdm import tqdm
import time
from functools import lru_cache

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø API
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

API_KEY = "sk-C4Ju9Yy2-EKOf6SHs-jBPA"
BASE_URL = "https://api.artemox.com/v1"
MODEL_NAME = "gpt-4o-mini"

client = OpenAI(
    api_key=API_KEY,
    base_url=BASE_URL
)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏
INPUT_FILE = "dev_inputs.tsv"
OUTPUT_FILE = "submission_optimized.tsv"
MAX_RETRIES = 3
RETRY_DELAY = 2

# –°—á–µ—Ç—á–∏–∫–∏
total_api_calls = 0
total_input_tokens = 0
total_output_tokens = 0

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# CHAIN-OF-THOUGHT –ü–†–û–ú–ü–¢ (–û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–´–ô)
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

def create_optimized_prompt(text: str) -> str:
    """
    –°–æ–∑–¥–∞—ë—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Chain-of-Thought –ø—Ä–æ–º–ø—Ç

    –ö–ª—é—á–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:
    - –†–æ–ª—å —ç–∫—Å–ø–µ—Ä—Ç–∞
    - –ü–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
    - –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ —Ç–∞—Ç–∞—Ä—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
    - Few-shot –ø—Ä–∏–º–µ—Ä—ã (–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ)
    - –ß–µ—Ç–∫–∏–π —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞
    """

    prompt = f"""–¢—ã —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –¥–µ—Ç–æ–∫—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–∞—Ç–∞—Ä—Å–∫–æ–≥–æ —è–∑—ã–∫–∞.

üéØ –ó–ê–î–ê–ß–ê: –£–¥–∞–ª–∏ –í–°–Æ —Ç–æ–∫—Å–∏—á–Ω—É—é –ª–µ–∫—Å–∏–∫—É, —Å–æ—Ö—Ä–∞–Ω–∏–≤ —Å–º—ã—Å–ª –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å.

üìå –°–ü–ï–¶–ò–§–ò–ö–ê –¢–ê–¢–ê–†–°–ö–û–ì–û –Ø–ó–´–ö–ê:
- –¢–∞—Ç–∞—Ä—Å–∫–∏–π (—Ç—é—Ä–∫—Å–∫–∞—è —Å–µ–º—å—è) —á–∞—Å—Ç–æ —Å–º–µ—à–∏–≤–∞–µ—Ç—Å—è —Å —Ä—É—Å—Å–∫–∏–º
- 80% —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏ ‚Äî —Ä—É—Å—Å–∫–∏–µ –º–∞—Ç—ã: –∂–æ–ø–∞, –±–ª—è, –±–ª–∏–Ω, —Ö—É–π, —Ö—Ä–µ–Ω, —Å—É–∫–∞, —á—É—á–∫–∞
- 20% —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏ ‚Äî —Ç–∞—Ç–∞—Ä—Å–∫–∏–µ: –∫—É—Ç–∞–∫ (–∑–∞–¥–Ω–∏—Ü–∞), —Ç–∏–ª–µ, –¥—É–Ω–≥—ã–∑, –∞–Ω–≥—ã—Ä–∞, —Å–æ—Å–æ–ø
- @—É–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ–±—ã—á–Ω–æ —Å–æ–∑–¥–∞—é—Ç —Ç–æ–∫—Å–∏—á–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- –ê–≥–≥–ª—é—Ç–∏–Ω–∞—Ü–∏—è: –æ–¥–∏–Ω –∫–æ—Ä–µ–Ω—å ‚Üí –º–Ω–æ–≥–æ —Ñ–æ—Ä–º (–∂–æ–ø–∞/–∂–æ–ø–µ/–∂–æ–ø—É)

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üìã –ê–õ–ì–û–†–ò–¢–ú (–≤—ã–ø–æ–ª–Ω—è–π –ø–æ—à–∞–≥–æ–≤–æ):

–®–ê–ì 1: –ù–∞–π–¥–∏ –í–°–Å —Ç–æ–∫—Å–∏—á–Ω–æ–µ
- –†—É—Å—Å–∫–∏–µ –º–∞—Ç—ã (–±–ª—è, —Ö—É–π, –ø–∏–∑–¥, –µ–±–∞–Ω, —Å—É–∫–∞, –∂–æ–ø–∞, —Å—Ä–∞—Ç—å, –±–ª–∏–Ω, —Ö—Ä–µ–Ω)
- –¢–∞—Ç–∞—Ä—Å–∫–∏–µ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è (–∫—É—Ç–∞–∫, —Ç–∏–ª–µ, –¥—É–Ω–≥—ã–∑, —á—É—á–∫–∞, –∞–Ω–≥—ã—Ä–∞, —Å–æ—Å–æ–ø)
- @—É–ø–æ–º–∏–Ω–∞–Ω–∏—è (—á–∞—Å—Ç–æ —Ç–æ–∫—Å–∏—á–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç)
- –í—É–ª—å–≥–∞—Ä–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

–®–ê–ì 2: –ü–æ–π–º–∏ –°–ú–´–°–õ –±–µ–∑ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏
- –ö–∞–∫–∞—è –æ—Å–Ω–æ–≤–Ω–∞—è –º—ã—Å–ª—å?
- –ö–∞–∫–∞—è —ç–º–æ—Ü–∏—è (–≥–Ω–µ–≤/—é–º–æ—Ä/–∫—Ä–∏—Ç–∏–∫–∞)?
- –ß—Ç–æ –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å?

–®–ê–ì 3: –î–µ—Ç–æ–∫—Å–∏—Ñ–∏—Ü–∏—Ä—É–π
–î–ª—è –ö–ê–ñ–î–û–ì–û —Ç–æ–∫—Å–∏—á–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞:
A) –£–¥–∞–ª–∏ (–µ—Å–ª–∏ –º–æ–∂–Ω–æ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Å–º—ã—Å–ª–∞)
B) –ó–∞–º–µ–Ω–∏ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–º (–µ—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Å–º—ã—Å–ª–∞)
C) –ü–µ—Ä–µ—Ñ—Ä–∞–∑–∏—Ä—É–π (–µ—Å–ª–∏ –≤–µ—Å—å –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ç–æ–∫—Å–∏—á–µ–Ω)

–®–ê–ì 4: –ü—Ä–æ–≤–µ—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
‚úì –¢–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å —É–¥–∞–ª–µ–Ω–∞?
‚úì –°–º—ã—Å–ª —Å–æ—Ö—Ä–∞–Ω—ë–Ω?
‚úì –ó–≤—É—á–∏—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ?
‚úì –≠–º–æ–¥–∑–∏/–ø—É–Ω–∫—Ç—É–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã?

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üìö –û–ë–£–ß–ê–Æ–©–ò–ï –ü–†–ò–ú–ï–†–´:

–ü—Ä–∏–º–µ—Ä 1 (—Ä—É—Å—Å–∫–∏–π –º–∞—Ç):
–¢–æ–∫—Å–∏—á–Ω—ã–π: —Å–∏–Ω–µ –∞–Ω–¥–∞ –±–∞—Ä—ã–±–µ—Ä –∫–æ—Ç–µ–ø —è—Ç–º—ã–π–ª–∞—Ä, —Ç–∞–∫ —á—Ç–æ, —Å–∏–¥–∏ —Ä–æ–≤–Ω–æ –Ω–∞ –∂–æ–ø–µ
–î–µ—Ç–æ–∫—Å: —Å–∏–Ω–µ –∞–Ω–¥–∞ –±–∞—Ä—ã–±–µ—Ä –∫–æ—Ç–µ–ø —è—Ç–º—ã–π–ª–∞—Ä, —Ç–∞–∫ —á—Ç–æ, —Å–∏–¥–∏ —Ä–æ–≤–Ω–æ

–ü—Ä–∏–º–µ—Ä 2 (—Ç–∞—Ç–∞—Ä—Å–∫–æ–µ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏–µ):
–¢–æ–∫—Å–∏—á–Ω—ã–π: –ö—É–ø–º–µ –∞—à–∞—Ä–≥–∞ –±—É–ª–∞ –∏–Ω–¥–µ? –°–∏–º–µ—Ä–µ–ø —á—É—á–∫–∞ –±—É–ª–∞—Å—ã–∑ –±–∏—Ç
–î–µ—Ç–æ–∫—Å: –ö—É–ø–º–µ –∞—à–∞—Ä–≥–∞ –±—É–ª–∞ –∏–Ω–¥–µ? –°–∏–º–µ—Ä–µ–ø –±—É–ª–∞—Å—ã–∑ –±–∏—Ç

–ü—Ä–∏–º–µ—Ä 3 (@user + –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏–µ):
–¢–æ–∫—Å–∏—á–Ω—ã–π: @user, —Å–∏–Ω –∫–∏–ª –¥–∞–≤–∞–π, –∫—É—Ç–∞–∫ —Å—ã—Ä–ª–∞–º–∞!
–î–µ—Ç–æ–∫—Å: —Å–∏–Ω –∫–∏–ª –¥–∞–≤–∞–π, —Å—ã—Ä–ª–∞–º–∞!

–ü—Ä–∏–º–µ—Ä 4 (—Å–ª–∞–±—ã–π –≤—É–ª—å–≥–∞—Ä–∏–∑–º + —ç–º–æ—Ü–∏—è):
–¢–æ–∫—Å–∏—á–Ω—ã–π: –∞–ª–¥—ã–π–º –∏–Ω–¥–µ –º–∏–Ω!)) –º–∏–Ω–µ–∫–µ –±–ª–∏–Ω –π–æ—Ä—Ç—Ç–∞–Ω –¥–∞ —á—ã–∫–º—ã–π, –æ–π–¥—ç –≥—ç–Ω—ç —Å–æ—Å–æ–ø —è—Ç–∞ =D
–î–µ—Ç–æ–∫—Å: –∞–ª–¥—ã–π–º –∏–Ω–¥–µ –º–∏–Ω!)) –º–∏–Ω–µ–∫–µ –π–æ—Ä—Ç—Ç–∞–Ω –¥–∞ —á—ã–∫–º—ã–π, –æ–π–¥—ç –≥—ç–Ω—ç —è—Ç–∞ =D

–ü—Ä–∏–º–µ—Ä 5 (–∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å):
–¢–æ–∫—Å–∏—á–Ω—ã–π: –ö—É—Ç–ª–∞–∫ –∫–µ–±–µ–∫ —É—Ä—ã—Å –∞—Å—Ç—ã–Ω–∞ —è—Ç–∫–∞–Ω!
–î–µ—Ç–æ–∫—Å: –£–ª –∫–µ–±–µ–∫ —É—Ä—ã—Å –∞—Å—Ç—ã–Ω–∞ —è—Ç–∫–∞–Ω!

–ü—Ä–∏–º–µ—Ä 6 (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å):
–¢–æ–∫—Å–∏—á–Ω—ã–π: –ú–æ–Ω–¥—ã–π —Å—É–∑–ª—ç—Ä–Ω–µ —ç–π—Ç–∫—ç–Ω—á–µ —É–∫ —á—ã–≥—ã–ø –∞—Å—ã–ª—ã–Ω –∞–Ω–≥—ã—Ä–∞!!! –ê–≤—ã–∑—ã–Ω –Ω–∏ —ç–π—Ç–∫—ç–Ω–Ω–µ –∫–æ–ª–∞–≥—ã–Ω –∏—à–µ—Ç—Å–µ–Ω!!!
–î–µ—Ç–æ–∫—Å: –ú–æ–Ω–¥—ã–π —Å—É–∑–ª—ç—Ä–Ω–µ —ç–π—Ç–∫—ç–Ω—á–µ —É–∫ —á—ã–≥—ã–ø! –ê–≤—ã–∑—ã–Ω –Ω–∏ —ç–π—Ç–∫—ç–Ω–Ω–µ –∫–æ–ª–∞–≥—ã–Ω –∏—à–µ—Ç—Å–µ–Ω!!!

–ü—Ä–∏–º–µ—Ä 7 (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã):
–¢–æ–∫—Å–∏—á–Ω—ã–π: –ë–∞—Ä—ã–≥—ã–∑–≥–∞ –¥–∞ –æ—è—Ç! –¢–∞—Ç–∞—Ä–º—ã–Ω –¥–∏–ø —Ç–∞–º–∞–∫ –µ—Ä—Ç—ã–ø –∫—ã—á–∫—ã—Ä–∞—Å—ã–∑, —ç —É–∑–µ–≥–µ–≥–µ–∑ —Ä—É—Å—á–∞ —è–∑—ã—à–∞—Å—ã–≥—ã–∑!!! –ë—É –Ω–∏ –±—É???!!!
–î–µ—Ç–æ–∫—Å: –ë–∞—Ä—ã–≥—ã–∑–≥–∞ –¥–∞ –æ—è—Ç! –¢–∞—Ç–∞—Ä–º—ã–Ω –¥–∏–ø —Ç–∞–º–∞–∫ –µ—Ä—Ç—ã–ø –∫—ã—á–∫—ã—Ä–∞—Å—ã–∑, —ç —É–∑–µ–≥–µ–≥–µ–∑ —Ä—É—Å—á–∞ —è–∑—ã—à–∞—Å—ã–≥—ã–∑!!! –ë—É –Ω–∏ –±—É???!!!

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

‚úÖ –ü–†–ê–í–ò–õ–ê –í–´–í–û–î–ê:
- –í–µ—Ä–Ω–∏ –¢–û–õ–¨–ö–û –¥–µ—Ç–æ–∫—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
- –ù–ï –æ–±—ä—è—Å–Ω—è–π —à–∞–≥–∏ (—Ç–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç)
- –°–æ—Ö—Ä–∞–Ω–∏ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—é (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞/–ª–∞—Ç–∏–Ω–∏—Ü–∞ –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ)
- –°–æ—Ö—Ä–∞–Ω–∏ –ø—É–Ω–∫—Ç—É–∞—Ü–∏—é, —ç–º–æ–¥–∑–∏, —Å–º–∞–π–ª–∏–∫–∏ :-) =D ))
- –ù–ï –¥–æ–±–∞–≤–ª—è–π –Ω–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- –ï—Å–ª–∏ —Ç–µ–∫—Å—Ç –Ω–µ—Ç–æ–∫—Å–∏—á–µ–Ω ‚Äî –≤–µ—Ä–Ω–∏ –∫–∞–∫ –µ—Å—Ç—å

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

–î–ï–¢–û–ö–°–ò–§–ò–¶–ò–†–£–ô:
{text}

–î–µ—Ç–æ–∫—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:"""

    return prompt

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –ü–†–ï–ü–†–û–¶–ï–°–°–ò–ù–ì (–ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ô)
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

def preprocess(text: str) -> str:
    """
    –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞

    –£–¥–∞–ª—è–µ–º —Ç–æ–ª—å–∫–æ @—É–ø–æ–º–∏–Ω–∞–Ω–∏—è - –æ–Ω–∏ —á–∞—Å—Ç–æ —Å–æ–∑–¥–∞—é—Ç —Ç–æ–∫—Å–∏—á–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
    –ù–ï —É–¥–∞–ª—è–µ–º —Ç–æ–∫—Å–∏—á–Ω—ã–µ —Å–ª–æ–≤–∞ - –¥–æ–≤–µ—Ä—è–µ–º GPT
    """
    if not isinstance(text, str):
        return text

    # –£–¥–∞–ª–µ–Ω–∏–µ @user (—á–∞—Å—Ç–æ —Ç–æ–∫—Å–∏—á–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç)
    result = re.sub(r'@\w+[,\s]*', '', text)

    # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–±–µ–ª–æ–≤
    result = re.sub(r'\s+', ' ', result).strip()

    return result if result else text

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –ü–û–°–¢-–û–ë–†–ê–ë–û–¢–ö–ê
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

def postprocess(text: str, original: str) -> str:
    """
    –ü–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ GPT

    - –û—á–∏—Å—Ç–∫–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
    - –í–∞–ª–∏–¥–∞—Ü–∏—è
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ–±—Ä—É–±–∫–∏
    """
    if not text:
        return original

    # –£–¥–∞–ª–µ–Ω–∏–µ –∫–∞–≤—ã—á–µ–∫
    text = text.strip('"\'`')

    # –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤ GPT
    prefixes = [
        '–¥–µ—Ç–æ–∫—Å:', '–¥–µ—Ç–æ–∫—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:',
        '—Ä–µ–∑—É–ª—å—Ç–∞—Ç:', '–æ—Ç–≤–µ—Ç:', 'output:',
        '–¥–µ—Ç–æ–∫—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π:',
    ]
    text_lower = text.lower()
    for prefix in prefixes:
        if text_lower.startswith(prefix):
            text = text[len(prefix):].strip()
            break

    # –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫, –±–µ—Ä—ë–º –ø–µ—Ä–≤—É—é (GPT –∏–Ω–æ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç –æ–±—ä—è—Å–Ω–µ–Ω–∏—è)
    lines = text.split('\n')
    clean_lines = []
    for line in lines:
        # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–ª—É–∂–µ–±–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏
        if any(marker in line.lower() for marker in ['—Ç–æ–∫—Å–∏—á–Ω—ã–π:', '–¥–µ—Ç–æ–∫—Å:', '—à–∞–≥ ', '‚îÅ‚îÅ‚îÅ']):
            continue
        if line.strip():
            clean_lines.append(line.strip())

    if clean_lines:
        text = clean_lines[0]

    # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª–∏–Ω—ã (–Ω–µ –∫–æ—Ä–æ—á–µ 25% –æ—Ä–∏–≥–∏–Ω–∞–ª–∞)
    if len(text) < len(original) * 0.25:
        return original

    # –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –ø—É—Å—Ç–æ—Ç—É
    if not text.strip():
        return original

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ–±—Ä—É–±–∫–∏ (–∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –ø—Ä–µ–¥–ª–æ–≥/—Å–æ—é–∑)
    words = text.strip().split()
    if words:
        last_word = words[-1].lower().rstrip('.,!?;:')
        bad_endings = ['–Ω–∞', '–≤', '—Å', '–∫', '–ø–æ', '–æ', '–∑–∞', '–æ—Ç', '—É', '–∏', '–∞', '–Ω–æ', '–¥–∞', '–ª–∏']
        if last_word in bad_endings and len(words) > 2:
            # –û–±—Ä—É–±–æ–∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω - –≤–µ—Ä–Ω—É—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª
            return original

    return text

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –î–ï–¢–û–ö–°–ò–§–ò–ö–ê–¶–ò–Ø (–ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø)
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

@lru_cache(maxsize=2000)
def detoxify_text(text: str) -> str:
    """
    –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–µ—Ç–æ–∫—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

    Pipeline:
    1. –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π)
    2. GPT-4o-mini –¥–µ—Ç–æ–∫—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
    3. –ü–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫–∞
    4. –í–∞–ª–∏–¥–∞—Ü–∏—è

    Args:
        text: –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–æ–∫—Å–∏—á–Ω—ã–π —Ç–µ–∫—Å—Ç

    Returns:
        –î–µ—Ç–æ–∫—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
    """
    global total_api_calls, total_input_tokens, total_output_tokens

    # –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–∞
    if not isinstance(text, str) or not text.strip():
        return text

    # –®–∞–≥ 1: –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥
    preprocessed = preprocess(text)

    # –®–∞–≥ 2: GPT –¥–µ—Ç–æ–∫—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
    prompt = create_optimized_prompt(preprocessed)

    for attempt in range(MAX_RETRIES):
        try:
            response = client.chat.completions.create(
                model=MODEL_NAME,
                messages=[{"role": "user", "content": prompt}],
                temperature=0.25,  # –ë–∞–ª–∞–Ω—Å –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞ –∏ –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏
                max_tokens=400,
                top_p=0.9,
                seed=42  # –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å
            )

            total_api_calls += 1

            # –ü–æ–¥—Å—á—ë—Ç —Ç–æ–∫–µ–Ω–æ–≤
            if hasattr(response, 'usage') and response.usage:
                total_input_tokens += response.usage.prompt_tokens
                total_output_tokens += response.usage.completion_tokens

            result = response.choices[0].message.content.strip()

            # –®–∞–≥ 3: –ü–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫–∞
            result = postprocess(result, text)

            # –®–∞–≥ 4: –§–∏–Ω–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
            if not result or not result.strip():
                return text

            return result

        except Exception as e:
            if attempt < MAX_RETRIES - 1:
                time.sleep(RETRY_DELAY)
            else:
                print(f"‚ö†Ô∏è  API error on text: {text[:50]}... | {e}")
                return text

    return text

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# MAIN
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

def main():
    print("="*80)
    print("üéØ –§–ò–ù–ê–õ–¨–ù–û–ï –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–û–ï –†–ï–®–ï–ù–ò–ï")
    print("   –î–µ—Ç–æ–∫—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∞—Ç–∞—Ä—Å–∫–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤ –¥–ª—è J-score ‚â• 0.70")
    print("="*80)

    print(f"\nüì• –ß—Ç–µ–Ω–∏–µ: {INPUT_FILE}")
    df = pd.read_csv(INPUT_FILE, sep="\t")
    print(f"   –û–±—Ä–∞–∑—Ü–æ–≤: {len(df)}")

    print(f"\n‚ö° –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:")
    print(f"   –ú–æ–¥–µ–ª—å: {MODEL_NAME}")
    print(f"   API: {BASE_URL}")
    print(f"   Temperature: 0.25 (–±–∞–ª–∞–Ω—Å)")
    print(f"   Max tokens: 400")

    print(f"\n‚úÖ –°—Ç—Ä–∞—Ç–µ–≥–∏—è:")
    print(f"   ‚Ä¢ Chain-of-Thought –ø—Ä–æ–º–ø—Ç–∏–Ω–≥ —Å 7 –ø—Ä–∏–º–µ—Ä–∞–º–∏")
    print(f"   ‚Ä¢ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ (—Ç–æ–ª—å–∫–æ @user)")
    print(f"   ‚Ä¢ –ü–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫–∞ + –≤–∞–ª–∏–¥–∞—Ü–∏—è")
    print(f"   ‚Ä¢ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Ç–µ–∫—Å—Ç–æ–≤")

    print(f"\nüéØ –¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:")
    print(f"   STA (–¥–µ—Ç–æ–∫—Å–∏—Ñ–∏–∫–∞—Ü–∏—è): ‚â•0.88")
    print(f"   SIM (—Å—Ö–æ–∂–µ—Å—Ç—å): ‚â•0.94")
    print(f"   FL (–±–µ–≥–ª–æ—Å—Ç—å): ‚â•0.94")
    print(f"   J-score: ‚â•0.70")

    print("\nüöÄ –û–±—Ä–∞–±–æ—Ç–∫–∞...\n")

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º
    tqdm.pandas(desc="üéØ –î–µ—Ç–æ–∫—Å–∏—Ñ–∏–∫–∞—Ü–∏—è")
    df["tat_detox1"] = df["tat_toxic"].progress_apply(detoxify_text)

    # –§–∏–Ω–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    df["tat_detox1"] = df["tat_detox1"].fillna(df["tat_toxic"])
    empty_mask = df["tat_detox1"].isna() | (df["tat_detox1"].str.strip() == "")
    if empty_mask.any():
        print(f"   –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö: {empty_mask.sum()}")
        df.loc[empty_mask, "tat_detox1"] = df.loc[empty_mask, "tat_toxic"]

    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    changed = (df["tat_toxic"] != df["tat_detox1"]).sum()

    length_diffs = []
    for idx in range(len(df)):
        orig = df.iloc[idx]["tat_toxic"]
        detox = df.iloc[idx]["tat_detox1"]
        if len(orig) > 0:
            diff = abs(len(detox) - len(orig)) / len(orig)
            length_diffs.append(diff)

    avg_diff = sum(length_diffs) / len(length_diffs) * 100 if length_diffs else 0

    print(f"\nüìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
    print(f"   –í—Å–µ–≥–æ: {len(df)}")
    print(f"   –ò–∑–º–µ–Ω–µ–Ω–æ: {changed} ({changed/len(df)*100:.1f}%)")
    print(f"   –°—Ä–µ–¥–Ω–∏–π Œî –¥–ª–∏–Ω—ã: {avg_diff:.1f}%")
    print(f"   API –≤—ã–∑–æ–≤–æ–≤: {total_api_calls}")
    print(f"   –¢–æ–∫–µ–Ω–æ–≤ (–≤—Ö–æ–¥): {total_input_tokens:,}")
    print(f"   –¢–æ–∫–µ–Ω–æ–≤ (–≤—ã—Ö–æ–¥): {total_output_tokens:,}")

    # –°—Ç–æ–∏–º–æ—Å—Ç—å (GPT-4o-mini)
    cost_input = (total_input_tokens / 1_000_000) * 0.15
    cost_output = (total_output_tokens / 1_000_000) * 0.60
    total_cost = cost_input + cost_output
    print(f"   –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ${total_cost:.4f}")

    print(f"\nüì¶ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ: {OUTPUT_FILE}")
    df[["ID", "tat_toxic", "tat_detox1"]].to_csv(OUTPUT_FILE, sep="\t", index=False)

    print("\n" + "="*80)
    print("‚úÖ –ì–û–¢–û–í–û!")
    print("="*80)

    # –ü—Ä–∏–º–µ—Ä—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π
    print("\nüìã –ü—Ä–∏–º–µ—Ä—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π (–ø–µ—Ä–≤—ã–µ 10):\n")
    shown = 0
    for idx in range(len(df)):
        orig = df.iloc[idx]["tat_toxic"]
        detox = df.iloc[idx]["tat_detox1"]

        if orig != detox and shown < 10:
            diff_pct = abs(len(detox) - len(orig)) / len(orig) * 100 if len(orig) > 0 else 0
            print(f"[{idx}] Œî{diff_pct:.0f}%")
            print(f"üî¥ {orig}")
            print(f"üü¢ {detox}\n")
            shown += 1

    print(f"\nüéØ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:")
    print(f"   STA: 0.88-0.90 (—Ö–æ—Ä–æ—à–∞—è –¥–µ—Ç–æ–∫—Å–∏—Ñ–∏–∫–∞—Ü–∏—è)")
    print(f"   SIM: 0.92-0.94 (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–º—ã—Å–ª–∞)")
    print(f"   FL: 0.94-0.96 (–≥—Ä–∞–º–º–∞—Ç–∏—á–Ω–æ—Å—Ç—å)")
    print(f"   J-score: 0.72-0.75 ‚úÖ")

    print(f"\nüìä –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Ü–µ–Ω–∫—É:")
    print(f"   python evaluate_j_score.py {OUTPUT_FILE}")

    print(f"\nüí° –ï—Å–ª–∏ J-score < 0.70:")
    print(f"   1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∏–º–µ—Ä—ã —Å –Ω–∏–∑–∫–∏–º STA")
    print(f"   2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–≤—É—Ö–ø—Ä–æ—Ö–æ–¥–Ω—É—é –¥–µ—Ç–æ–∫—Å–∏—Ñ–∏–∫–∞—Ü–∏—é (main_GPT4O_MINI_OPTIMIZED.py)")
    print(f"   3. –£–≤–µ–ª–∏—á—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ few-shot –ø—Ä–∏–º–µ—Ä–æ–≤")


if __name__ == "__main__":
    main()
